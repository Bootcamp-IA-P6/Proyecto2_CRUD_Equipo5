<!-- templates/renting/home.html -->
{% extends 'renting/base.html' %}
{% load static %}

{% block content %}
<!-- Search & Filter Section -->
<section class="mb-5 p-4 bg-white rounded shadow-sm border">
    <div class="row g-3 align-items-end">
        <!-- Basic Keyword Search -->
        <div class="col-md-4">
            <label class="form-label fw-bold small">Keyword Search</label>
            <input type="text" id="search-input" class="form-control" placeholder="Brand or model...">
        </div>
        <!-- Date Availability Filters -->
        <div class="col-md-3">
            <label class="form-label fw-bold small">Pick-up Date</label>
            <input type="date" id="available-from" class="form-control">
        </div>
        <div class="col-md-3">
            <label class="form-label fw-bold small">Return Date</label>
            <input type="date" id="available-to" class="form-control">
        </div>
        <div class="col-md-2">
            <button class="btn btn-primary w-100 py-2 fw-bold" onclick="loadVehicles(true)">Search</button>
        </div>
    </div>

    <!-- Advanced Filters Toggle Button -->
    <div class="mt-3">
        <button class="btn btn-link btn-sm text-decoration-none p-0" type="button" data-bs-toggle="collapse" data-bs-target="#advancedFilters">
            ⚙️ Advanced Filters & Sorting
        </button>
    </div>

    <!-- Advanced Filter Section (Collapsible) -->
    <div class="collapse mt-3" id="advancedFilters">
        <div class="row g-3 pt-3 border-top">
            <div class="col-md-3">
                <label class="form-label small">Vehicle Type</label>
                <select class="form-select form-select-sm" id="filter-type">
                    <option value="">All Types</option>
                </select>
            </div>
            <div class="col-md-2">
                <label class="form-label small">Transmission</label>
                <select class="form-select form-select-sm" id="filter-trans">
                    <option value="">All</option>
                    <option value="Automatic">Automatic</option>
                    <option value="Manual">Manual</option>
                </select>
            </div>
            <div class="col-md-2">
                <label class="form-label small">Seats</label>
                <select class="form-select form-select-sm" id="filter-seats">
                    <option value="">Any</option>
                    <option value="2">2 Seats</option>
                    <option value="4">4 Seats</option>
                    <option value="5">5 Seats</option>
                    <option value="7">7+ Seats</option>
                </select>
            </div>
            <div class="col-md-3">
                <label class="form-label small">Sort By</label>
                <select class="form-select form-select-sm" id="sort-order">
                    <option value="">Default</option>
                    <option value="car_model__daily_price">Price: Low to High</option>
                    <option value="-car_model__daily_price">Price: High to Low</option>
                </select>
            </div>
            <div class="col-md-2 d-flex align-items-end">
                <button class="btn btn-outline-secondary btn-sm w-100" onclick="clearAllFilters()">Clear All</button>
            </div>
        </div>
    </div>
</section>

<!-- Vehicle Grid - Populated by JavaScript -->
<div class="vehicle-grid" id="vehicle-list"></div>

<!-- Hybrid Pagination Controls -->
<div id="pagination-controls" class="text-center mt-5 mb-5">
    <!-- Loading Spinner (shows during data fetch) -->
    <div id="loading-spinner" class="spinner-border text-primary d-none" role="status"></div>
    
    <!-- Load More Button (fallback for infinite scroll) -->
    <button id="load-more-btn" class="btn btn-outline-dark px-5 py-2 d-none" onclick="loadVehicles()">
        Load More Vehicles
    </button>
    
    <!-- End of Results Message -->
    <p id="no-more-msg" class="text-muted d-none">No more vehicles to display.</p>
</div>

<!-- Scroll Sentinel (Intersection Observer target) -->
<div id="scroll-sentinel" style="height: 10px;"></div>

<!-- Home Page JavaScript -->
<script src="{% static 'renting/js/home.js' %}"></script>
{% endblock %}
